üìò Overview

This lab demonstrates the exploitation of format string vulnerabilities in C programs. By manipulating input passed unsafely to printf() and related functions, attackers can crash programs, leak memory contents, modify memory, and even execute arbitrary code. Using a 32-bit vulnerable server and Docker containers, we performed hands-on attacks including stack/heap memory disclosure, variable overwrites, and reverse shell injection.

üß™ Key Lab Tasks

Task 1: Crash the program using %n to exploit uncontrolled formatting.

Task 2: Leak memory from the stack and heap using crafted format specifiers like %x and %s.

Task 3: Modify memory to:

Change arbitrary variable values.

Set target variable to exact values (e.g., 0x5000, 0xAABBCCDD) using %n, %hn.

Task 4: Inject & execute shellcode by modifying return addresses and achieving a reverse shell on the attacker‚Äôs machine using custom payloads.

Task 5: Patch the vulnerability by using format string placeholders ("%s", msg) to prevent arbitrary formatting and remove compiler warnings.

üí° What I Learned

How unsafe use of format strings leads to critical vulnerabilities.

Stack layout and memory manipulation techniques through %n, %x, %s, %hn, and custom shellcode.

Practical use of tools like Python, GDB, Netcat, and Docker to construct and deliver exploits.

How to create reverse shells by redirecting I/O using TCP sockets.

The importance of secure coding practices and compiler-level protections in mitigating such attacks.

üåç Real-World Applications

Offensive Security: Skills align with penetration testing, ethical hacking, and CTF-style challenges involving format string and memory corruption attacks.

Secure Development: Understanding how unvalidated user input leads to low-level memory corruption helps developers write safer C/C++ code.

Incident Response & Reverse Engineering: Insight into attacker behavior helps in malware analysis and memory forensic investigations.

DevOps & Cloud Security: Working with Docker and Linux-based services to assess container security and detect vulnerabilities in microservices.
